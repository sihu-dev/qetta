# BIDFLOW ìë™ ì½”ë“œ ë¦¬ë·°
# PR ìƒì„± ì‹œ Claude Opus 4.5ë¡œ ì½”ë“œ í’ˆì§ˆ/ë³´ì•ˆ/ì„±ëŠ¥ ê²€ìˆ˜

name: Claude Code Review

on:
  pull_request:
    types: [opened, synchronize, ready_for_review]
    paths:
      - 'src/**'
      - 'bidflow/**'

permissions:
  contents: read
  pull-requests: write

jobs:
  code-review:
    runs-on: ubuntu-latest
    if: github.event.pull_request.draft == false

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Claude Code Review
        uses: anthropics/claude-code-action@v1
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          model: claude-opus-4-5-20251101
          max_turns: 5
          prompt: |
            PR #${{ github.event.pull_request.number }} ì½”ë“œ ë¦¬ë·°

            ì œëª©: ${{ github.event.pull_request.title }}

            ë‹¤ìŒ 5ê°€ì§€ ê´€ì ì—ì„œ ê²€ìˆ˜í•´ì£¼ì„¸ìš” (ê° 20ì , ì´ 100ì ):

            1. **ì½”ë“œ í’ˆì§ˆ (20ì )**
               - TypeScript strict mode ì¤€ìˆ˜
               - any íƒ€ì… ì‚¬ìš© ì—¬ë¶€
               - ì½”ë“œ ê°€ë…ì„±

            2. **ë³´ì•ˆ (20ì )**
               - XSS, SQL Injection ì·¨ì•½ì 
               - API í‚¤ í•˜ë“œì½”ë”© ì—¬ë¶€
               - ì…ë ¥ ê²€ì¦ (Zod)

            3. **ì„±ëŠ¥ (20ì )**
               - ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§
               - ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ê°€ëŠ¥ì„±
               - ë²ˆë“¤ ì‚¬ì´ì¦ˆ ì˜í–¥

            4. **ë””ìì¸ ì‹œìŠ¤í…œ (20ì )**
               - ëª¨ë…¸í¬ë¡¬ íŒ”ë ˆíŠ¸ ì¤€ìˆ˜ (neutral ê³„ì—´ë§Œ)
               - ê¸ˆì§€ ìƒ‰ìƒ ì‚¬ìš© ì—¬ë¶€
               - ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ

            5. **ì•„í‚¤í…ì²˜ (20ì )**
               - Repository íŒ¨í„´ ì¤€ìˆ˜
               - Server/Client ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬
               - API v1 ë²„ì €ë‹

      - name: Post Review Comment
        uses: actions/github-script@v7
        with:
          script: |
            await github.rest.pulls.createReview({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.payload.pull_request.number,
              event: 'COMMENT',
              body: 'ğŸ¤– **Claude Code Review ì™„ë£Œ**\n\nìë™ ê²€ìˆ˜ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìœ„ ê²°ê³¼ë¥¼ ì°¸ê³ í•˜ì—¬ ì½”ë“œë¥¼ ê°œì„ í•´ì£¼ì„¸ìš”.'
            });
